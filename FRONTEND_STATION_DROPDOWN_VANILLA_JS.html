<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Station Dropdown Example</title>
</head>
<body>
    <h1>Station Dropdown Example</h1>
    
    <label for="stationSelect">Select Station:</label>
    <select id="stationSelect">
        <option value="">Loading stations...</option>
    </select>

    <script>
        // Configuration
        const API_BASE_URL = 'http://localhost:8080';
        const STATIONS_ENDPOINT = `${API_BASE_URL}/station/getAll`;

        // Get auth token from your storage (adjust based on your implementation)
        function getAuthToken() {
            return localStorage.getItem('authToken') || sessionStorage.getItem('authToken');
        }

        // Fetch stations from API
        async function fetchStations() {
            const selectElement = document.getElementById('stationSelect');
            const token = getAuthToken();

            try {
                const response = await fetch(STATIONS_ENDPOINT, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const stations = await response.json();
                    populateDropdown(stations);
                } else if (response.status === 401) {
                    selectElement.innerHTML = '<option value="">Authentication required</option>';
                    console.error('Authentication failed');
                } else if (response.status === 403) {
                    selectElement.innerHTML = '<option value="">You do not have permission</option>';
                    console.error('Permission denied');
                } else {
                    selectElement.innerHTML = '<option value="">Failed to load stations</option>';
                    console.error('Failed to fetch stations');
                }
            } catch (error) {
                console.error('Error fetching stations:', error);
                selectElement.innerHTML = '<option value="">Error loading stations</option>';
            }
        }

        // Populate dropdown with stations
        function populateDropdown(stations) {
            const selectElement = document.getElementById('stationSelect');
            
            // Clear existing options
            selectElement.innerHTML = '';
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'Select Station';
            selectElement.appendChild(defaultOption);
            
            // Add station options
            stations.forEach(station => {
                const option = document.createElement('option');
                option.value = station.id;
                option.textContent = station.name;
                selectElement.appendChild(option);
            });

            // Add change event listener
            selectElement.addEventListener('change', function(e) {
                const selectedStationId = e.target.value;
                const selectedStationName = e.target.options[e.target.selectedIndex].text;
                console.log('Selected Station ID:', selectedStationId);
                console.log('Selected Station Name:', selectedStationName);
                
                // You can use the selectedStationId in your form submission
                // For example, add it to a hidden input or form data
            });
        }

        // Load stations when page loads
        window.addEventListener('DOMContentLoaded', fetchStations);
    </script>
</body>
</html>






